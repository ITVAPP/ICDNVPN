{
  // 统计信息配置
  "stats": {},  // 空对象，启用基础统计功能
  
  // API配置
  "api": {
    "tag": "api",
    "services": ["StatsService"]  // 启用统计服务API
  },
  
  // 本地策略配置
  "policy": {
    "levels": {
      "0": {  // 用户级别0的策略
        "handshake": 5,        // 握手超时时间（秒）
        "connIdle": 300,       // 连接空闲超时时间（秒）
        "uplinkOnly": 2,       // 仅上行连接超时时间（秒）
        "downlinkOnly": 3,     // 仅下行连接超时时间（秒）
        "statsUserUplink": true,   // 启用用户上行流量统计
        "statsUserDownlink": true, // 启用用户下行流量统计
        "bufferSize": 512      // 缓冲区大小（KB）
      }
    },
    "system": {
      "statsInboundUplink": true,    // 启用入站上行流量统计
      "statsInboundDownlink": true,  // 启用入站下行流量统计
      "statsOutboundUplink": true,   // 启用出站上行流量统计
      "statsOutboundDownlink": true  // 启用出站下行流量统计
    }
  },
  
  "inbounds": [
    {
      // 虚拟 DNS 入站
      "tag": "dns-in",
      "port": 10853,
      "listen": "127.0.0.1",
      "protocol": "dokodemo-door",
      "settings": {
        "address": "8.8.8.8",
        "port": 53,
        "network": "tcp,udp"
      }
    },
    {
      "tag": "socks",
      "port": 7898,
      "protocol": "socks",
      "settings": {
        "auth": "noauth",
        "udp": true
      }
    },
    {
      // HTTP 代理服务器
      "tag": "http",
      "port": 7899,              // 监听端口
      "protocol": "http",        // HTTP 协议
      "sniffing": {              // 流量探测配置
        "enabled": true,         // 启用探测
        "destOverride": ["http", "tls"], // 探测 HTTP 和 TLS 流量
        "routeOnly": true        // 仅用于路由判断，不改变目标地址
      },
      "settings": {
        "auth": "noauth",        // 无需认证
        "udp": true,             // 支持 UDP
        "allowTransparent": false // 不允许透明代理
      }
    },
    {
      // API 管理接口
      "tag": "api",
      "port": 10085,             // API 端口
      "listen": "127.0.0.1",     // 仅本地访问
      "protocol": "dokodemo-door", // 任意门协议
      "settings": {
        "address": "127.0.0.1"   // 目标地址
      }
    }
  ],
  "outbounds": [
    {
      // DNS 出站
      "tag": "dns-out",
      "protocol": "dns"
    },
    {
      "tag": "proxy",
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "104.16.44.219",
            "port": 80,
            "users": [
              {
                "id": "bc24baea-3e5c-4107-a231-416cf00504fe",
                "alterId": 0,
                "email": "t@t.tt",
                "security": "auto",
                "encryption": "none"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "ws",
        "security": "",
        "wsSettings": {
          "path": "/?ed=2560",
          "headers": {
            "Host": "pagesvless.jeseelim.workers.dev"
          }
        },
        "tlsSettings": {
          "serverName": "pagesvless.jeseelim.workers.dev",
          "allowInsecure": false,
          "alpn": ["http/1.1"],
          "fingerprint": "chrome"
        }
      },
      "mux": {
        "enabled": false,
        "concurrency": -1
      }
    },
    {
      "tag": "direct",
      "protocol": "freedom",
      "settings": {}
    },
    {
      "tag": "block",
      "protocol": "blackhole",
      "settings": {
        "response": {
          "type": "http"
        }
      }
    }
  ],

  // DNS 配置
  "dns": {
    "hosts": {                   // 静态 DNS 映射
      "dns.google": "8.8.8.8",
      "dns.cloudflare.com": "1.1.1.1",
      "cloudflare-dns.com": "1.1.1.1"
    },
    "servers": [
      {
        // 中国大陆域名使用阿里 DNS
        "address": "223.5.5.5",
        "domains": [
          "geosite:cn",           // 中国大陆网站
          "geosite:geolocation-cn" // 中国大陆地理位置网站
        ],
        "skipFallback": false     // 不跳过备用 DNS
      },
      "1.1.1.1",                 // Cloudflare DNS
      "8.8.8.8"                  // Google DNS
    ],
    "disableCache": false,       // 启用DNS缓存
    "disableFallback": false     // 启用备用DNS
  },
  
  // 路由配置
  "routing": {
    "domainStrategy": "AsIs",  
    "rules": [
      {
        // API路由规则
        "type": "field",
        "inboundTag": ["api"],     // 来自API入站的流量
        "outboundTag": "api"       // 路由到API出站
      },
      {
        // 虚拟 DNS：DNS 入站流量路由到 dns-out
        "type": "field",
        "inboundTag": ["dns-in"],
        "port": 53,
        "network": "udp,tcp",
        "outboundTag": "dns-out"
      },
      {
        // 非虚拟 DNS：SOCKS 入站的 DNS 流量（UDP 53）路由到 dns-out
        "type": "field",
        "inboundTag": ["socks"],
        "port": 53,
        "network": "tcp,udp",
        "outboundTag": "dns-out"
      },
      {
        // 特定 DNS 服务器通过代理
        "type": "field",
        "outboundTag": "proxy",
        "ip": ["1.1.1.1", "8.8.8.8"],
        "port": 53,
        "network": "tcp,udp"
      },
      {
        // 直连 123 端口 UDP 流量（NTP 协议）
        "type": "field",
        "outboundTag": "direct",
        "port": 123,
        "network": "udp"
      },
      {
        // BT 流量直连
        "type": "field",
        "outboundTag": "direct",
        "protocol":["bittorrent"]
      },
      {
        // 中国大陆域名直连
        "type": "field",
        "outboundTag": "direct",
        "domain": [
          "geosite:cn",               // 中国大陆网站
          "geosite:geolocation-cn"    // 中国大陆地理位置网站
        ]
      },
      {
        // 中国大陆 IP 直连
        "type": "field",
        "outboundTag": "direct",
        "ip": [
          "geoip:private",   // 私有 IP 地址
          "geoip:cn"         // 中国大陆 IP
        ]
      },
      {
          "type": "field",
          "outboundTag": "block",
          "domain": [
          "geosite:category-ads-all"
          ]
      },
      {
        // 默认规则：其他所有流量通过代理
        "type": "field",
        "network": "udp,tcp",
        "outboundTag": "proxy"
      }
    ]
  }
}
